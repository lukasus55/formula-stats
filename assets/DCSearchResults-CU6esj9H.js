import{r as l,f as R,j as e,L as S}from"./index-BBUaGlRn.js";import{u as M}from"./index-BR725ydH.js";import{n as g,L as $,e as A}from"./LoadingError-BAv70R7y.js";import{L as E}from"./LoadingMini-LMd164mA.js";g.registerLocale(A);function I({query:c,searchType:d}){const f=c.toLowerCase(),i=f.split("_"),[r,N]=l.useState([]),[u,L]=l.useState(25),[p,m]=l.useState(!1);function x(s){let t;return i.length===2?t=s.filter(a=>a.givenName.toLowerCase().includes(i[0])&&a.familyName.toLowerCase().includes(i[1])):t=s.filter(a=>i.some(n=>a.id.toLowerCase().includes(n)||a.givenName.toLowerCase().includes(n)||a.familyName.toLowerCase().includes(n))),t}const[j,C]=l.useState(0),[D,v]=l.useState([]),{data:o,error:w,isLoading:y}=M(`https://api.jolpi.ca/ergast/f1/${d}/?offset=${j}&limit=100`,R);l.useEffect(()=>{o&&(y?(m(!1),setTimeout(()=>{h()},251)):h())},[o,f]);function h(){if(o.MRData.DriverTable.Drivers.length>0){const s=o.MRData.DriverTable.Drivers.map(t=>({id:t.driverId,givenName:t.givenName,familyName:t.familyName,countryCode:g.getAlpha2Code(t.nationality,"en")||"99"}));v(t=>[...t,...s]),C(t=>t+100)}else m(!0);N(x(D))}if(w)return e.jsx($,{});if(!p)return e.jsx("div",{className:"dcsearch-loading",children:e.jsx(E,{})});const b=()=>{L(s=>s+25)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dcsearch-results-title",children:[r.length," ",r.length===1?"result":"results"," for ",c.replace("_"," ")]}),e.jsxs("div",{className:"dcsearch-results-box",children:[r.slice(0,u).map(s=>e.jsx("div",{className:"dcsearch-results-single-result",children:e.jsxs(S,{to:`/${d}?id=${s.id}`,className:"dcsearch-results-link",children:[e.jsx("span",{className:`fi fi-${s.countryCode.toLowerCase()} dcsearch-results-flag`})," ",s.givenName," ",e.jsx("span",{className:"dcsearch-results-familyName",children:s.familyName})]})},s.id)),u<r.length?e.jsx("div",{className:"dcsearch-results-load-more",children:e.jsx("button",{onClick:b,className:"dcsearch-results-load-more-button",children:"Load More"})}):""]})]})}export{I as default};
