import{r as l,f as R,j as e,L as S}from"./index-DbYkr5Sb.js";import{u as M}from"./index-CyU8yK_R.js";import{n as g,e as $}from"./flag-icons.min-D-3jLYHq.js";import{L as A}from"./LoadingMini-Db9FiF0d.js";g.registerLocale($);function _({query:c,searchType:d}){const f=c.toLowerCase(),i=f.split("_"),[r,N]=l.useState([]),[m,p]=l.useState(25),[x,u]=l.useState(!1);function L(s){let t;return i.length===2?t=s.filter(a=>a.givenName.toLowerCase().includes(i[0])&&a.familyName.toLowerCase().includes(i[1])):t=s.filter(a=>i.some(n=>a.id.toLowerCase().includes(n)||a.givenName.toLowerCase().includes(n)||a.familyName.toLowerCase().includes(n))),t}const[j,C]=l.useState(0),[v,D]=l.useState([]),{data:o,error:w,isLoading:k,isValidating:y}=M(`https://api.jolpi.ca/ergast/f1/${d}/?offset=${j}&limit=100`,R);l.useEffect(()=>{o&&(y?(u(!1),setTimeout(()=>{h()},251)):h())},[o,f]);function h(){if(o.MRData.DriverTable.Drivers.length>0){const s=o.MRData.DriverTable.Drivers.map(t=>({id:t.driverId,givenName:t.givenName,familyName:t.familyName,countryCode:g.getAlpha2Code(t.nationality,"en")||"99"}));D(t=>[...t,...s]),C(t=>t+100)}else u(!0);N(L(v))}if(w)return e.jsx("div",{className:"dcsearch-loading-error",children:"Failed to load."});if(!x)return e.jsx("div",{className:"dcsearch-loading",children:e.jsx(A,{})});const b=()=>{p(s=>s+25)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dcsearch-results-title",children:[r.length," ",r.length===1?"result":"results"," for ",c.replace("_"," ")]}),e.jsxs("div",{className:"dcsearch-results-box",children:[r.slice(0,m).map(s=>e.jsx("div",{className:"dcsearch-results-single-result",children:e.jsxs(S,{to:`/${d}?id=${s.id}`,className:"dcsearch-results-link",children:[e.jsx("span",{className:`fi fi-${s.countryCode.toLowerCase()} dcsearch-results-flag`})," ",s.givenName," ",e.jsx("span",{className:"dcsearch-results-familyName",children:s.familyName})]})},s.id)),m<r.length?e.jsx("div",{className:"dcsearch-results-load-more",children:e.jsx("button",{onClick:b,className:"dcsearch-results-load-more-button",children:"Load More"})}):""]})]})}export{_ as default};
