import{r as i,f as b,j as e,L as M}from"./index-DEcwyZa_.js";import{u as R}from"./index-CwNhhgBI.js";import{n as g,e as S}from"./flag-icons.min-CRPKH2Vo.js";import{L as $}from"./LoadingMini-DMmR8q9k.js";g.registerLocale(S);function _({query:c,searchType:d}){const m=c.toLowerCase(),l=m.split("_"),[r,N]=i.useState([]),[u,x]=i.useState(25),[p,f]=i.useState(!1);function L(s){let t;return l.length===2?t=s.filter(a=>a.givenName.toLowerCase().includes(l[0])&&a.familyName.toLowerCase().includes(l[1])):t=s.filter(a=>l.some(n=>a.id.toLowerCase().includes(n)||a.givenName.toLowerCase().includes(n)||a.familyName.toLowerCase().includes(n))),t}const[j,C]=i.useState(0),[h,v]=i.useState([]),{data:o,error:D,isLoading:w}=R(`https://api.jolpi.ca/ergast/f1/${d}/?offset=${j}&limit=100`,b);if(i.useEffect(()=>{o&&(f(!0),setTimeout(()=>{if(o.MRData.DriverTable.Drivers.length>0){const s=o.MRData.DriverTable.Drivers.map(t=>({id:t.driverId,givenName:t.givenName,familyName:t.familyName,countryCode:g.getAlpha2Code(t.nationality,"en")||"99"}));v(t=>[...t,...s]),C(t=>t+100)}else N(L(h)),f(!1)},251))},[o,m]),D)return e.jsx("div",{className:"dcsearch-loading-error",children:"Failed to load."});if(w&&h.length===0||p)return e.jsx("div",{className:"dcsearch-loading",children:e.jsx($,{})});const y=()=>{x(s=>s+25)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dcsearch-results-title",children:[" ",r.length," ",r.length==1?"result":"results",' for "',c.replace("_"," "),'" ']}),e.jsxs("div",{className:"dcsearch-results-box",children:[r.slice(0,u).map(s=>e.jsx("div",{className:"dcsearch-results-single-result",children:e.jsxs(M,{to:`/${d}?id=${s.id}`,className:"dcsearch-results-link",children:[e.jsx("span",{className:`fi fi-${s.countryCode.toLowerCase()} dcsearch-results-flag`})," ",s.givenName," ",e.jsx("span",{className:"dcsearch-results-familyName",children:s.familyName})]})},s.id)),u<r.length?e.jsx("div",{className:"dcsearch-results-load-more",children:e.jsx("button",{onClick:y,className:"dcsearch-results-load-more-button",children:"Load More"})}):""]})]})}export{_ as default};
