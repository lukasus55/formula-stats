import{r as i,f as S,j as e,c as M}from"./index-C8ZzusaC.js";import{u as $}from"./index-Pz_XEerW.js";import{n as g,e as A}from"./en-CF9NGsFN.js";import{L as E}from"./flag-icons.min-Dy0dlpe5.js";import{L as k}from"./LoadingMini-9_uacvLC.js";g.registerLocale(A);function O({query:c,searchType:d}){const f=c.toLowerCase(),l=f.split("_"),[r,N]=i.useState([]),[m,p]=i.useState(25),[L,u]=i.useState(!1);function x(s){let t;return l.length===2?t=s.filter(a=>a.givenName.toLowerCase().includes(l[0])&&a.familyName.toLowerCase().includes(l[1])):t=s.filter(a=>l.some(n=>a.id.toLowerCase().includes(n)||a.givenName.toLowerCase().includes(n)||a.familyName.toLowerCase().includes(n))),t}const[j,C]=i.useState(0),[D,v]=i.useState([]),{data:o,error:w,isLoading:y,isValidating:b}=$(`https://api.jolpi.ca/ergast/f1/${d}/?offset=${j}&limit=100`,S);i.useEffect(()=>{o&&(y||b?(u(!1),setTimeout(()=>{h()},251)):h())},[o,f]);function h(){if(o.MRData.DriverTable.Drivers.length>0){const s=o.MRData.DriverTable.Drivers.map(t=>({id:t.driverId,givenName:t.givenName,familyName:t.familyName,countryCode:g.getAlpha2Code(t.nationality,"en")||"99"}));v(t=>[...t,...s]),C(t=>t+100)}else u(!0);N(x(D))}if(w)return e.jsx(E,{});if(!L)return e.jsx("div",{className:"dcsearch-loading",children:e.jsx(k,{})});const R=()=>{p(s=>s+25)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dcsearch-results-title",children:[r.length," ",r.length===1?"result":"results"," for ",c.replace("_"," ")]}),e.jsxs("div",{className:"dcsearch-results-box",children:[r.slice(0,m).map(s=>e.jsx("div",{className:"dcsearch-results-single-result",children:e.jsxs(M,{to:`/${d}?id=${s.id}`,className:"dcsearch-results-link",children:[e.jsx("span",{className:`fi fi-${s.countryCode.toLowerCase()} dcsearch-results-flag`})," ",s.givenName," ",e.jsx("span",{className:"dcsearch-results-familyName",children:s.familyName})]})},s.id)),m<r.length?e.jsx("div",{className:"dcsearch-results-load-more",children:e.jsx("button",{onClick:R,className:"dcsearch-results-load-more-button",children:"Load More"})}):""]})]})}export{O as default};
